# Event Processing Skill

The event-processing skill provides comprehensive management capabilities for NetXMS event processing system. This skill enables you to understand, configure, and manage how events flow through the NetXMS system, from generation to final processing.

## Overview

Event processing in NetXMS is a core mechanism that handles various types of events generated throughout the monitoring infrastructure. Events represent significant occurrences in the monitored environment and can originate from multiple sources:

- **Monitoring agents** - Events from NetXMS agents running on monitored systems
- **SNMP traps** - Network device notifications received via SNMP
- **Syslog messages** - System log entries from various devices and applications  
- **Internal monitoring** - Events generated by NetXMS server's internal monitoring processes
- **User actions** - Events triggered by administrative actions or scripts

## Event Templates

Event templates define the structure and properties of events that can be generated in NetXMS. Each template includes:

- **Event code** - Unique numeric identifier (system events: < 100000, user-defined: >= 100000)
- **Event name** - Human-readable name for the event (alphanumeric with underscores)
- **Severity level** - normal, warning, minor, major, or critical
- **Message format** - Template for event message text with parameter placeholders (%1, %2, etc.)
- **Description** - Detailed explanation of when and why the event occurs
- **Tags** - Comma-separated categorization labels for grouping and filtering

Event templates serve as blueprints that ensure consistent event generation and provide context for event processing rules.

### Managing Event Templates

You can create, modify, and delete event templates using the provided functions:

#### Creating Event Templates
Use `create-event-template` to create new custom event templates. Required parameters:
- **name** - Unique name (alphanumeric with underscores, e.g., `MY_CUSTOM_EVENT`)
- **severity** - One of: normal, warning, minor, major, critical
- **message** - Message template with optional placeholders (%1, %2 for parameters)

Optional parameters:
- **description** - Detailed description of when the event occurs
- **tags** - Comma-separated tags for categorization

Example use cases:
- Create events for custom monitoring scenarios
- Define events for integration with external systems
- Set up events for specific business logic in NXSL scripts

#### Modifying Event Templates
Use `modify-event-template` to update existing user-defined templates (code >= 100000). You can modify:
- Name (via newName parameter)
- Severity
- Message template
- Description
- Tags

**Note:** System event templates (code < 100000) cannot be modified.

#### Deleting Event Templates
Use `delete-event-template` to remove user-defined templates that are no longer needed.

**Note:** System event templates (code < 100000) cannot be deleted.

## Event Processing Policy

The Event Processing Policy (EPP) is a comprehensive rule engine that determines how events are handled when they occur. The policy consists of ordered rules that can:

### Filtering and Conditions
- **Source filtering** - Process events only from specific objects or groups; all children of provided object will also match filter
- **Event filtering** - Process only specific event codes
- **Severity filtering** - Process only events with specific severity
- **Time-based conditions** - Apply rules only during certain time periods
- **Custom conditions** - Use NXSL scripts for complex conditional logic

### Actions
- **Alarm generation** - Create, update, or terminate alarms based on events
- **Notifications** - Send alerts via email, SMS, instant messaging, or other channels
- **Script execution** - Run custom scripts or external commands
- **Command execution** - Trigger command execution on management server or remote node via agent
- **Object management** - Modify object properties, status, or configuration

### Event Correlation
- **Event suppression** - Prevent duplicate or redundant events from generating multiple alarms
- **Event escalation** - Increase severity or change handling based on event patterns
- **Root cause analysis** - Correlate related events to identify underlying issues
- **Time-based correlation** - Group events occurring within specific time windows

## Key Concepts

### Event Flow
1. **Generation** - Events are created by various sources using defined templates
2. **Script hook** - NXSL script Hook::EventProcessor is called
3. **Policy processing** - Events flow through EPP rules in order
4. **Action execution** - Matching rules trigger their configured actions
5. **Logging** - Events are recorded in the event log for auditing

### Rule Processing
- Rules are processed in sequential order (top to bottom)
- Multiple rules can match the same event if configured appropriately
- Rules can be configured to stop or continue processing after a match (default is to continue processing)

## Server-Side Actions

NetXMS supports several types of server-side actions that can be executed when EPP rules match events:

### Action Types

1. **Execute command on management server**
   - Executes provided command directly on the NetXMS server node
   - Requires appropriate permissions for the netxmsd process user
   - Useful for local administrative tasks and system commands

2. **Execute command on remote node**
   - Executes predefined commands on remote nodes via NetXMS agent
   - Command must be defined in the agent's configuration file
   - Supports parameters: `commandName param1 param2 param3...`
   - Remote host field supports macros and multiple formats:
     - `hostname` - Hostname or IP address (use `%a` for event source IP)
     - `@name` - Node name (allows identification behind proxy)
   - Requires appropriate permissions for the nxagentd process user

3. **Send notification**
   - Sends notifications via configured channels (SMS, email, Microsoft Teams, etc.)
   - Uses notification channels configured separately
   - Message text supports macros for dynamic content
   - Can target multiple recipients
   - Supports various notification drivers

4. **Execute NXSL script**
   - Executes scripts from the NetXMS script library
   - Provides full scripting capabilities for complex logic
   - Can access event data and system objects
   - Allows custom automation and integration

5. **Forward event**
   - Forwards events to another NetXMS server
   - Useful for distributed monitoring scenarios
   - Requires proper configuration on both source and destination servers
   - Destination server must have EnableISCListener and ReceiveForwardedEvents enabled

### Action Features

- **Delay and Timer Keys**: Actions can have delay times to prevent execution if problems resolve quickly
- **Escalation**: Multiple actions with different delays for escalating notifications
- **Macros Support**: Actions support macros for dynamic content and parameters
- **Cancellation**: Delay timers can be canceled by other EPP rules (e.g., when problems resolve)

### Common Use Cases

- **Automated Response**: Execute corrective commands when issues are detected
- **Notification Escalation**: Send alerts to different people based on problem duration
- **Integration**: Forward events to external systems or other NetXMS servers
- **Custom Logic**: Use NXSL scripts for complex decision-making and automation
- **Problem Prevention**: Execute preventive actions before issues become critical

## Use Cases

### Monitoring and Alerting
- Configure automatic alarm generation for critical system events
- Set up escalation procedures for unacknowledged critical alarms
- Implement notification routing based on event severity and time of day

### Compliance and Auditing
- Track security-related events and generate compliance reports
- Monitor configuration changes and administrative actions
- Maintain audit trails for regulatory requirements

### Operational Automation
- Trigger automated remediation scripts for known issues
- Coordinate maintenance activities based on system events
- Implement self-healing capabilities for common problems

### Performance Optimization
- Suppress redundant events to reduce noise
- Correlate performance events to identify trends
- Generate capacity planning alerts based on threshold violations

This skill provides the tools to effectively manage and optimize your event processing configuration, ensuring that your monitoring system responds appropriately to all significant events in your infrastructure.