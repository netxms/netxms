# Log Analysis Skill

This skill provides comprehensive log analysis capabilities for NetXMS. Use this skill to search, correlate, and analyze logs from multiple sources including syslog, Windows events, SNMP traps, system events, and custom log tables from server modules.

## Key Capabilities

- **Log Discovery**: Discover available logs with `list-logs` and understand their schema with `get-log-schema`
- **Universal Search**: Search any log table with the unified `search-log` function
- **Log Correlation**: Cross-correlate events across multiple sources and network neighbors
- **Pattern Detection**: Identify recurring patterns, message bursts, and new error patterns
- **Statistical Analysis**: Analyze log volume trends for capacity planning

## Use Cases

- **Troubleshooting**: Correlate logs around an incident to identify root cause
- **Security Investigation**: Search for failed logins, audit events, and security-related messages
- **Compliance Auditing**: Export specific log entries for audit trails
- **Capacity Planning**: Analyze log volume trends and identify busy periods
- **Anomaly Detection**: Detect unusual patterns, bursts, and new error messages
- **Custom Module Logs**: Search logs from custom server modules

## Recommended Workflow

1. **Discover Available Logs**: Use `list-logs` to see all accessible logs
2. **Understand Schema**: Use `get-log-schema` to learn column names and types
3. **Search with Filters**: Use `search-log` with appropriate filters based on schema
4. **Correlate**: Use `correlate-logs` to see related events across sources
5. **Analyze Patterns**: Use `analyze-log-patterns` to detect anomalies

## Available Functions

### Discovery Functions

- `list-logs`: List all available logs the user can access (includes custom module logs)
- `get-log-schema`: Get detailed schema for a log including column types and descriptions

### Search Functions

- `search-log`: Universal search for any log table with flexible filtering
- `search-syslog`: Specialized search for syslog messages with severity/facility filters
- `search-windows-events`: Search Windows Event Log entries by log name, event code, etc.
- `search-snmp-traps`: Search SNMP traps by OID, source IP, and varbind content
- `search-events`: Search NetXMS system events by code, severity, origin, and tags

### Analysis Functions

- `get-log-statistics`: Get volume statistics with grouping by time, source, or severity
- `correlate-logs`: Create unified timeline across log sources for a device and its neighbors
- `analyze-log-patterns`: Detect bursts, recurring patterns, new messages, and top patterns

## Built-in Logs

| Log Name | Description |
|----------|-------------|
| syslog | RFC 5424 syslog messages from network devices and servers |
| WindowsEventLog | Windows Event Log entries from monitored Windows hosts |
| SnmpTrapLog | SNMP traps received from network devices |
| EventLog | NetXMS system events from monitoring, thresholds, scripts |
| AlarmLog | Current and historical alarms (alerts) |
| AuditLog | Security audit trail for user actions and changes |
| NotificationLog | Notification delivery history |
| MaintenanceJournal | Maintenance notes and observations |
| AssetChangeLog | Asset attribute change tracking |
| ServerActionExecutionLog | Server-side action execution history |
| PackageDeploymentLog | Software package deployment history |
| AITaskLog | AI assistant task execution history |

## Reference Data

### Syslog Severity Levels

| Level | Name | Description |
|-------|------|-------------|
| 0 | Emergency | System unusable |
| 1 | Alert | Immediate action required |
| 2 | Critical | Critical conditions |
| 3 | Error | Error conditions |
| 4 | Warning | Warning conditions |
| 5 | Notice | Normal but significant |
| 6 | Informational | Informational messages |
| 7 | Debug | Debug-level messages |

### Syslog Facility Codes

| Code | Name | Code | Name |
|------|------|------|------|
| 0 | kern | 12 | ntp |
| 1 | user | 13 | security |
| 2 | mail | 14 | console |
| 3 | daemon | 15 | clock |
| 4 | auth | 16-23 | local0-7 |

### Windows Event Severity

| Value | Name |
|-------|------|
| 1 | Error |
| 2 | Warning |
| 4 | Information |
| 8 | Audit Success |
| 16 | Audit Failure |

### NetXMS Event Severity

| Value | Name |
|-------|------|
| 0 | Normal |
| 1 | Warning |
| 2 | Minor |
| 3 | Major |
| 4 | Critical |

### Event Origins

| Origin | Description |
|--------|-------------|
| SYSTEM | Internal NetXMS events |
| SNMP | Generated from SNMP traps |
| SYSLOG | Generated from syslog messages |
| AGENT | Events from NetXMS agents |
| SCRIPT | Events generated by NXSL scripts |
| WINDOWS_EVENT | From Windows Event Log |

### Column Types

When using `get-log-schema`, columns have the following types:

| Type | Description |
|------|-------------|
| text | Free-form text |
| text_details | Large text (details view) |
| timestamp | Unix timestamp |
| integer | Numeric value |
| object_id | Reference to NetXMS object |
| user_id | Reference to user |
| event_code | Event template code |
| severity | Alarm/event severity level |
| alarm_state | Alarm state enum |
| zone_uin | Zone identifier |

## Time Parameters

All time parameters support:
- **ISO 8601 format**: `2026-01-07T10:30:00Z`
- **Relative format**: `-60m` (60 minutes ago), `-1h` (1 hour ago), `-1d` (1 day ago)

## Pattern Types

When using `analyze-log-patterns`:
- **frequency**: Top patterns by occurrence count
- **burst**: Periods with abnormally high message volume (Z-score >= 3.0)
- **recurring**: Patterns that occur at regular intervals (hourly, daily, etc.)
- **new**: Patterns that first appeared recently
- **all**: Run all detection types (default)

## Using search-log with filters

The `search-log` function accepts a `filters` parameter for column-specific filtering:

```json
{
  "log_name": "AlarmLog",
  "filters": {
    "current_severity": [3, 4],
    "alarm_state": 0
  }
}
```

This searches alarms with severity Major(3) or Critical(4) that are outstanding (state=0).

## Best Practices

- Use `list-logs` first to discover available logs (especially for custom module logs)
- Use `get-log-schema` to understand column names and types before searching
- Start with narrow time windows and expand if needed
- Use object filter to focus on specific devices
- Combine search with correlation for complete picture
- Check pattern analysis for recurring issues before concluding root cause
- Use statistics to understand normal baseline before investigating anomalies
