# Log Analysis Skill

This skill provides comprehensive log analysis capabilities for NetXMS. Use this skill to search, correlate, and analyze logs from multiple sources including syslog, Windows events, SNMP traps, and system events.

## Key Capabilities

- **Search Logs**: Query syslog, Windows events, SNMP traps, and system events with flexible filtering
- **Log Correlation**: Cross-correlate events across multiple sources and network neighbors
- **Pattern Detection**: Identify recurring patterns, message bursts, and new error patterns
- **Statistical Analysis**: Analyze log volume trends for capacity planning

## Use Cases

- **Troubleshooting**: Correlate logs around an incident to identify root cause
- **Security Investigation**: Search for failed logins, audit events, and security-related messages
- **Compliance Auditing**: Export specific log entries for audit trails
- **Capacity Planning**: Analyze log volume trends and identify busy periods
- **Anomaly Detection**: Detect unusual patterns, bursts, and new error messages

## Available Functions

### Search Functions

- `search-syslog`: Search syslog messages with filters for severity, facility, source, and text
- `search-windows-events`: Search Windows Event Log entries by log name, event code, and severity
- `search-snmp-traps`: Search SNMP traps by OID, source IP, and varbind content
- `search-events`: Search NetXMS system events by code, severity, origin, and tags

### Analysis Functions

- `get-log-statistics`: Get volume statistics with grouping by time, source, or severity
- `correlate-logs`: Create unified timeline across log sources for a device and its neighbors
- `analyze-log-patterns`: Detect bursts, recurring patterns, new messages, and top patterns

## Analysis Workflow

1. **Initial Search**: Use search functions to find relevant log entries
2. **Correlation**: Use `correlate-logs` to see related events across sources
3. **Pattern Analysis**: Use `analyze-log-patterns` to detect anomalies
4. **Statistics**: Use `get-log-statistics` for volume trends

## Reference Data

### Syslog Severity Levels

| Level | Name | Description |
|-------|------|-------------|
| 0 | Emergency | System unusable |
| 1 | Alert | Immediate action required |
| 2 | Critical | Critical conditions |
| 3 | Error | Error conditions |
| 4 | Warning | Warning conditions |
| 5 | Notice | Normal but significant |
| 6 | Informational | Informational messages |
| 7 | Debug | Debug-level messages |

### Syslog Facility Codes

| Code | Name | Code | Name |
|------|------|------|------|
| 0 | kern | 12 | ntp |
| 1 | user | 13 | security |
| 2 | mail | 14 | console |
| 3 | daemon | 15 | clock |
| 4 | auth | 16-23 | local0-7 |

### Windows Event Severity

| Value | Name |
|-------|------|
| 1 | Error |
| 2 | Warning |
| 4 | Information |
| 8 | Audit Success |
| 16 | Audit Failure |

### NetXMS Event Severity

| Value | Name |
|-------|------|
| 0 | Normal |
| 1 | Warning |
| 2 | Minor |
| 3 | Major |
| 4 | Critical |

### Event Origins

| Origin | Description |
|--------|-------------|
| SYSTEM | Internal NetXMS events |
| SNMP | Generated from SNMP traps |
| SYSLOG | Generated from syslog messages |
| AGENT | Events from NetXMS agents |
| SCRIPT | Events generated by NXSL scripts |
| WINDOWS_EVENT | From Windows Event Log |

## Time Parameters

All time parameters support:
- **ISO 8601 format**: `2026-01-07T10:30:00Z`
- **Relative format**: `-60m` (60 minutes ago), `-1h` (1 hour ago), `-1d` (1 day ago)

## Pattern Types

When using `analyze-log-patterns`:
- **frequency**: Top patterns by occurrence count
- **burst**: Periods with abnormally high message volume (Z-score >= 3.0)
- **recurring**: Patterns that occur at regular intervals (hourly, daily, etc.)
- **new**: Patterns that first appeared recently
- **all**: Run all detection types (default)

## Best Practices

- Start with narrow time windows and expand if needed
- Use object filter to focus on specific devices
- Combine search with correlation for complete picture
- Check pattern analysis for recurring issues before concluding root cause
- Use statistics to understand normal baseline before investigating anomalies
