/*
** Metadata
**
** ex: syntax=sql
*/

INSERT INTO metadata (var_name,var_value)
	VALUES ('SchemaVersion',DB_FORMAT_VERSION);
INSERT INTO metadata (var_name,var_value)
	VALUES ('Syntax',DB_SYNTAX);

INSERT INTO metadata (var_name,var_value)
	VALUES ('IDataTableCreationCommand','CREATE TABLE idata_%d (item_id integer not null,idata_timestamp integer not null,idata_value varchar(255) null)');
#if defined(DB_POSTGRESQL)
INSERT INTO metadata (var_name,var_value)
	VALUES ('IDataIndexCreationCommand_0','CREATE INDEX idx_idata_%d_timestamp_id ON idata_%d(idata_timestamp,item_id)');
#elif defined(DB_MSSQL)
INSERT INTO metadata (var_name,var_value)
	VALUES ('IDataIndexCreationCommand_0','CREATE CLUSTERED INDEX idx_idata_%d_id_timestamp ON idata_%d(item_id,idata_timestamp)');
#else
INSERT INTO metadata (var_name,var_value)
	VALUES ('IDataIndexCreationCommand_0','CREATE INDEX idx_idata_%d_id_timestamp ON idata_%d(item_id,idata_timestamp)');
#endif

INSERT INTO metadata (var_name,var_value)
	VALUES ('TDataTableCreationCommand_0','CREATE TABLE tdata_%d (item_id integer not null,tdata_timestamp integer not null,record_id ' CONCAT SQL_INT64_TEXT CONCAT ' not null,UNIQUE(record_id))');
INSERT INTO metadata (var_name,var_value)
	VALUES ('TDataTableCreationCommand_1','CREATE TABLE tdata_records_%d (record_id ' CONCAT SQL_INT64_TEXT CONCAT ' not null,row_id ' CONCAT SQL_INT64_TEXT CONCAT ' not null,instance varchar(255) null,PRIMARY KEY(row_id),FOREIGN KEY (record_id) REFERENCES tdata_%d(record_id) ON DELETE CASCADE)');
INSERT INTO metadata (var_name,var_value)
	VALUES ('TDataTableCreationCommand_2','CREATE TABLE tdata_rows_%d (row_id ' CONCAT SQL_INT64_TEXT CONCAT ' not null,column_id integer not null,value varchar(255) null,PRIMARY KEY(row_id,column_id),FOREIGN KEY (row_id) REFERENCES tdata_records_%d(row_id) ON DELETE CASCADE)');
#if defined(DB_POSTGRESQL)
INSERT INTO metadata (var_name,var_value)
	VALUES ('TDataIndexCreationCommand_0','CREATE INDEX idx_tdata_%d_timestamp_id ON tdata_%d(tdata_timestamp,item_id)');
#elif defined(DB_MSSQL)
INSERT INTO metadata (var_name,var_value)
	VALUES ('TDataIndexCreationCommand_0','CREATE CLUSTERED INDEX idx_tdata_%d_id_timestamp ON tdata_%d(item_id,tdata_timestamp)');
#else
INSERT INTO metadata (var_name,var_value)
	VALUES ('TDataIndexCreationCommand_0','CREATE INDEX idx_tdata_%d_id_timestamp ON tdata_%d(item_id,tdata_timestamp)');
#endif
INSERT INTO metadata (var_name,var_value)
	VALUES ('TDataIndexCreationCommand_1','CREATE INDEX idx_tdata_rec_%d_instance ON tdata_records_%d(instance)');
