{
  "formatVersion": 6,
  "nxslVersionV5": true,
  "server": {
    "version": "5.2.0-rc227",
    "buildTag": "5.2-227-g487f5d3281",
    "operatingSystem": "Linux 6.17.0-8-generic"
  },
  "description": "MikroTik authentication failure alarms from syslog",
  "events": [
    {
      "guid": "eaf1db72-369a-49c2-a29d-a2d5ebb510eb",
      "name": "SYSLOG_MKT_LOGIN_FAILURE",
      "code": 100125,
      "description": "Generated when system receives a login failure syslog message from a MikroTik device\r\nParameters:\r\n   1) Username that failed to log in\r\n   2) Login method (telnet, ssh, winbox, etc.)",
      "severity": 3,
      "flags": 1,
      "message": "Login for user \"%1\" failed via \"%2\"",
      "tags": ""
    },
    {
      "guid": "b9d834af-6777-4495-b8ed-9e239c5c08b4",
      "name": "SYSLOG_MKT_AUTH_FAILURE",
      "code": 100124,
      "description": "Generated when system receives an authentication failure syslog message from a MikroTik device\r\nParameters:\r\n   1) Access method\r\n   2) Username that failed to log in",
      "severity": 2,
      "flags": 1,
      "message": "Authentication failure for user \"%2\" over \"%1\"",
      "tags": ""
    },
    {
      "guid": "769e60f6-f11d-45a7-b4d1-6d2365e3ae97",
      "name": "SYSLOG_MKT_ROUTING_AUTH_FAILED",
      "code": 100126,
      "description": "Generated when system receives a routing authentication failure syslog message from a MikroTik device\r\nParameters:\r\n   1) Routing protocol\r\n   2) Authentication method",
      "severity": 3,
      "flags": 1,
      "message": "Routing - \"%1\" authentication failed - using \"%2\"",
      "tags": ""
    }
  ],
  "templates": [],
  "traps": [],
  "rules": [
    {
      "id": 74,
      "guid": "e57274b3-8923-44d3-a050-9f869dbdea7b",
      "flags": 7944,
      "sources": [],
      "sourceExclusions": [],
      "events": [
        {
          "name": "SYSLOG_MKT_AUTH_FAILURE",
          "id": 100124
        }
      ],
      "timeFrames": [],
      "actions": [],
      "timerCancellations": [],
      "comments": "Generate authentication failure alarms based on MikroTik syslog parsing",
      "downtimeTag": "",
      "filterScript": "",
      "actionScript": "",
      "alarmMessage": "%m",
      "alarmImpact": null,
      "alarmSeverity": 5,
      "alarmKey": "SL_MKT_AUTH_FAIL_%i_%1",
      "alarmTimeout": 0,
      "alarmTimeoutEvent": "SYS_ALARM_TIMEOUT",
      "rootCauseAnalysisScript": null,
      "alarmCategories": [],
      "pstorageSetActions": {},
      "pstorageDeleteActions": [],
      "customAttributeSetActions": {},
      "customAttributeDeleteActions": [],
      "aiAgentInstructions": null,
      "incidentDelay": 0,
      "incidentTitle": null,
      "incidentDescription": null,
      "incidentAIAnalysisDepth": 0,
      "incidentAIPrompt": null
    },
    {
      "id": 75,
      "guid": "9c4720ea-aa72-482b-9b8b-74f6fe51cc52",
      "flags": 7944,
      "sources": [],
      "sourceExclusions": [],
      "events": [
        {
          "name": "SYSLOG_MKT_LOGIN_FAILURE",
          "id": 100125
        }
      ],
      "timeFrames": [],
      "actions": [],
      "timerCancellations": [],
      "comments": "Generate login failure alarms based on MikroTik syslog parsing",
      "downtimeTag": "",
      "filterScript": "",
      "actionScript": "",
      "alarmMessage": "%m",
      "alarmImpact": null,
      "alarmSeverity": 5,
      "alarmKey": "SL_MKT_LOGIN_FAIL_%i_%2",
      "alarmTimeout": 0,
      "alarmTimeoutEvent": "SYS_ALARM_TIMEOUT",
      "rootCauseAnalysisScript": null,
      "alarmCategories": [],
      "pstorageSetActions": {},
      "pstorageDeleteActions": [],
      "customAttributeSetActions": {},
      "customAttributeDeleteActions": [],
      "aiAgentInstructions": null,
      "incidentDelay": 0,
      "incidentTitle": null,
      "incidentDescription": null,
      "incidentAIAnalysisDepth": 0,
      "incidentAIPrompt": null
    },
    {
      "id": 76,
      "guid": "dca74ea0-9cca-4d35-8f04-0996d99afa4f",
      "flags": 7944,
      "sources": [],
      "sourceExclusions": [],
      "events": [
        {
          "name": "SYSLOG_MKT_ROUTING_AUTH_FAILED",
          "id": 100126
        }
      ],
      "timeFrames": [],
      "actions": [],
      "timerCancellations": [],
      "comments": "Generate routing protocol authentication failure alarms based on MikroTik syslog parsing",
      "downtimeTag": "",
      "filterScript": "",
      "actionScript": "",
      "alarmMessage": "%m",
      "alarmImpact": null,
      "alarmSeverity": 5,
      "alarmKey": "SL_MKT_ROUT_AUTH_FAIL_%i_%1",
      "alarmTimeout": 0,
      "alarmTimeoutEvent": "SYS_ALARM_TIMEOUT",
      "rootCauseAnalysisScript": null,
      "alarmCategories": [],
      "pstorageSetActions": {},
      "pstorageDeleteActions": [],
      "customAttributeSetActions": {},
      "customAttributeDeleteActions": [],
      "aiAgentInstructions": null,
      "incidentDelay": 0,
      "incidentTitle": null,
      "incidentDescription": null,
      "incidentAIAnalysisDepth": 0,
      "incidentAIPrompt": null
    }
  ],
  "ruleOrdering": [
    "daae10db-c3f7-4f40-b32f-a37b08ec76ed",
    "9ef49e64-f399-46fa-9d50-1bd44e1ed0ac",
    "b2a139dd-5a41-4992-8e23-d45ee6757567",
    "2d2c3d32-49d4-4e76-b6aa-782b30d90f28",
    "4fa20604-b56f-4f12-bb5d-2c3243a126c9",
    "45999e66-c16c-400d-8b79-63a0f8eb8958",
    "8537fa14-e824-435b-a1dd-be3e566b7f67",
    "2daa869f-9921-4f3e-9cb9-004c2f31f70a",
    "95d42ff2-6fe0-4b1c-9c7b-c18520393f9f",
    "6f46d451-ee66-4563-8747-d129877df24d",
    "727a0dca-ecc4-4490-bf4b-3fc8b5ff8cb4",
    "11176d3e-0149-448b-a5fe-2be764762775",
    "ecc3fb57-672d-489d-a0ef-4214ea896e0f",
    "5b8115f1-5c84-443a-9f88-18fc0b70f29e",
    "062228ef-c155-4669-a90a-603cae13240e",
    "943f5474-5614-44e1-820c-b8fe17bc4d0b",
    "9ce6b59e-e274-4c94-b314-4b4652c10c74",
    "e3120a33-216e-e048-aa3b-4f1a9f3f10fc",
    "bdc76d2e-967e-bf44-95a1-a229ef8b3ff4",
    "226de02d-9eb2-4ea1-a92c-2bdb1718f2ec",
    "02a21afe-c942-4953-8b5d-f463c597cff8",
    "4f7c2c1a-5adc-45d7-b328-bdce956bac29",
    "47fd5c32-b6c9-48b8-99fb-c389dde63bee",
    "dcdd6f93-2f9e-4c3e-97cb-95b6847f13ce",
    "d3acabe8-717d-4ceb-bb7f-498d5af898f2",
    "8e26af4b-e478-44c9-9c12-0b049ccb6c3c",
    "ea1dee96-b42e-499c-a992-0b0f9e4874b9",
    "f0c5a6b2-7427-45e5-8333-7d60d2b408e6",
    "b76f142a-6932-499e-aa6e-ac16cf8effb1",
    "ed3397a8-a496-4534-839b-5a6fc77c167c",
    "20a0f4a5-d90e-4961-ba88-a65b9ee45d07",
    "c6f66840-4758-420f-a27d-7bbf7b66a511",
    "9fa60260-c2ec-4371-b4e4-f5346b1d8400",
    "20ef861f-b8e4-4e04-898e-e57d13863661",
    "33f6193a-e103-4f5f-8bee-870bbcc08066",
    "417648af-5361-49a5-9471-6ef31e857b2d",
    "19bd89ba-8bb2-4915-8546-a1ecc650dedd",
    "cff7fe6b-2ad1-4c18-8a8f-4d397d44fe04",
    "68e102a3-58d3-4112-901c-f683356ba662",
    "68a629ef-c645-49e5-8a7b-c5e79308080e",
    "18507220-6a16-4e13-a6ba-141d907b924a",
    "8cca36cd-f821-43ae-8329-0eefe35df3b7",
    "404642a0-deb0-400d-b9f9-c86f5a83f7f5",
    "b8abb037-ab4a-4e05-adc4-9425ce440e4a",
    "2bb3df47-482b-4e4b-9b49-8c72c6b33011",
    "b517ca11-cdf8-4813-87fa-9a2ace070564",
    "bdd8f6b1-fe3a-4b20-bc0b-bb7507b264b2",
    "c19fbb37-98c9-43a5-90f2-7a54ba9116fa",
    "aa188673-049f-4c4d-8767-c1cf443c9547",
    "af00706c-b92a-4335-b441-190609c2494f",
    "9169a40b-cd9d-4328-b113-f690ef57773e",
    "d1cec35b-3a04-4b68-94cf-8e00aa483e12",
    "81320995-d6db-4a3c-9670-12400eba4fe6",
    "96061edf-a46f-407a-a049-a55fa1ffb7e8",
    "75640293-d630-4bfc-9b5e-9655cf59fd00",
    "c00d895a-832a-431e-87b6-822064629c63",
    "73fbf22e-e101-4cd6-b51c-078589140d03",
    "1499d2d3-2304-4bb1-823b-0c530cbb6224",
    "acbf02d5-3ff1-4235-a8a8-f85755b9a06b",
    "ddcf2019-9659-48ee-9e38-ec2906a8f3be",
    "8e2038ef-1105-4f47-b23b-e6968155969c",
    "d99d2df0-ee3f-4bd6-bd5a-2f720543b3ba",
    "e34d8443-e3b7-4b09-a386-6deb6746bcf5",
    "202d5b85-48fc-4b6e-9da9-53a6eb9a341d",
    "256c2abd-3e14-4e02-9606-7c78c77e1a78",
    "9d49d42f-4d27-436c-b392-c5cab3046698",
    "52396754-fdf5-4cea-8d44-9e5d8354ceb1",
    "bd82c390-b754-4806-ae52-cd7ef90fc0e7",
    "9eca1a1e-671e-4a2f-9d38-13c74cfce600",
    "683442ae-a533-4e13-b91a-2fdf93a9e750",
    "f7d34997-2e1b-4216-bf01-54b4bd1cb81e",
    "0761b4d7-87da-4c2e-aabb-062a19d68a17",
    "8d22e47b-305c-45ea-a14a-6e9a50d7e4ab",
    "e57274b3-8923-44d3-a050-9f869dbdea7b",
    "9c4720ea-aa72-482b-9b8b-74f6fe51cc52",
    "dca74ea0-9cca-4d35-8f04-0996d99afa4f"
  ],
  "scripts": [],
  "objectTools": [],
  "dciSummaryTables": [],
  "actions": [],
  "webServiceDefinitions": [],
  "assetManagementSchema": [],
  "syslog": {
    "rules": [
      {
        "guid": "41d0ea34-1c9d-4d14-951a-a11c1f4df0af",
        "content": "<rule guid=\"41d0ea34-1c9d-4d14-951a-a11c1f4df0af\" name=\"MikroTik login failure\"><match repeatInterval=\"0\" reset=\"false\">system,error,critical login failure for user (.*) from .* via (.*)</match><event>SYSLOG_MKT_LOGIN_FAILURE</event><facility>1</facility><tag>system</tag><agentAction action=\"\"/></rule>"
      },
      {
        "guid": "df3abea5-f39e-4cd8-acc0-9d8749921798",
        "content": "<rule guid=\"df3abea5-f39e-4cd8-acc0-9d8749921798\" name=\"MikroTik user authentication failure\"><match repeatInterval=\"0\" reset=\"false\"> (.*),error : user (.*) authentication failed</match><event>SYSLOG_MKT_AUTH_FAILURE</event><facility>1</facility><agentAction action=\"\"/></rule>"
      },
      {
        "guid": "3b35c657-bdd8-42fe-ba54-e94ad4de89a7",
        "content": "<rule guid=\"3b35c657-bdd8-42fe-ba54-e94ad4de89a7\" name=\"MikroTik routing protocol authentication failure\"><match repeatInterval=\"0\" reset=\"false\">route,(.*),info Discarding packet: (.*) authentication failed</match><event>SYSLOG_MKT_ROUTING_AUTH_FAILED</event><facility>1</facility><tag>route</tag><agentAction action=\"\"/></rule>"
      }
    ],
    "order": [
      "41d0ea34-1c9d-4d14-951a-a11c1f4df0af",
      "df3abea5-f39e-4cd8-acc0-9d8749921798",
      "3b35c657-bdd8-42fe-ba54-e94ad4de89a7"
    ]
  },
  "winlog": {
    "rules": [],
    "order": []
  }
}
